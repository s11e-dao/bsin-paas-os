package me.flyray.bsin.blockchain.conflux;

import com.fasterxml.jackson.databind.ObjectMapper;
import conflux.web3j.Account;
import conflux.web3j.AccountManager;
import conflux.web3j.Web3;
import conflux.web3j.response.Receipt;
import conflux.web3j.types.Address;
import conflux.web3j.types.RawTransaction;
import conflux.web3j.types.SendTransactionResult;
import conflux.web3j.types.TransactionBuilder;
import org.junit.Test;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.web3j.abi.datatypes.Type;
import org.web3j.abi.datatypes.Utf8String;
import org.web3j.abi.datatypes.generated.Uint256;
import org.web3j.crypto.*;
import org.web3j.protocol.ObjectMapperFactory;
import org.web3j.utils.Convert;

import java.math.BigDecimal;
import java.math.BigInteger;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;

/**
 * @author ：leonard
 * @date ：Created in 2023/09/26
 * @description：conflux公链测试
 * @modified By：
 */

//@RunWith(PowerMockRunner.class)
//@PowerMockIgnore({"javax.net.ssl.*"})
@SpringBootApplication
public class confluxTest {

//    public static String confluxWalletAddress = "0x1d23e8060f646bad1b4bb9125a5d1e71f56cb32f";
//
//    @Test
//    public void buildWeb3Client() throws Exception {
//        Web3 web3 = Web3.create("https://test.confluxrpc.com/v2", 3, 1000);
//    }
//
//
////    /**
////     * confluxWeb3Test
////     */
////    @Test
////    public void confluxWeb3Test() throws Exception {
////        ConfluxWeb3 confluxWeb3 = new ConfluxWeb3(daoContractMapper);
////        Map<String, Object> result = new HashMap<>();
////        result = confluxWeb3.createWallet("123456", "test");
////        String address = confluxWeb3.getAddress("test", result.get("privateKey").toString());
////        System.out.println("address: " + address);
////        String blanceMATIC = confluxWeb3.getBalance("test", "cfxtest:aarpncc5f4s3fxrr4vf4s4ye253t18tc825p0dg9u0");
////        System.out.println("blanceCFX: " + blanceMATIC);
////    }
//
//    @Test
//    public void openChainAccount() throws Exception {
//        Web3 web3 = Web3.create("https://test.confluxrpc.com/v2", 3, 1000);
//        String password = "123456";
//        WalletFile walletFile;
//        ECKeyPair ecKeyPair = Keys.createEcKeyPair();
//        walletFile = Wallet.createStandard(password, ecKeyPair);
//        System.out.println("address " + walletFile.getAddress());
//        ObjectMapper objectMapper = ObjectMapperFactory.getObjectMapper();
//        String jsonStr = objectMapper.writeValueAsString(walletFile);
//        System.out.println("keystore json file " + jsonStr);
//        Credentials credentials = WalletUtils.loadJsonCredentials(password, jsonStr);
//        String address = credentials.getAddress();
//        BigInteger publicKey = credentials.getEcKeyPair().getPublicKey();
//        BigInteger privateKey = credentials.getEcKeyPair().getPrivateKey();
//        String sPrivatekeyInHex = privateKey.toString(16);
//        System.out.println(sPrivatekeyInHex);
//        System.out.println("address=" + address);
//        System.out.println("public key=" + publicKey);
//        System.out.println("private key=" + privateKey);
//
//        Account account = Account.create(web3, sPrivatekeyInHex);
//        System.out.println(account.getAddress());
//        System.out.println(account.getHexAddress());
//
//        /*String walletFileName0="";//文件名
//        String walletFilePath0="E:\\block-workspace\\data";
//        //钱包文件保持路径，请替换位自己的某文件夹路径
//        walletFileName0 = WalletUtils.generateNewWalletFile("123456", new File(walletFilePath0), false);
//        System.out.println(walletFileName0);*/
//    }
//
//    /**
//     * 部署一个智能合约
//     *
//     * @throws Exception
//     */
//    @Test
//    public void deployContract() throws Exception {
//        String privateKey = "6e88746088c5d054f983131babd915eac0ea2764879c5b732044bfed903fe70c";
//        Web3 web3 = Web3.create("https://test.confluxrpc.com/v2", 3, 1000);
//        Account account = Account.create(web3, privateKey);
//        Account.Option opt = new Account.Option();
//        // opt要设置chainId ！！不然报错chainIdMismatch
//        opt.withChainId(1);
//        //opt.withGasLimit(111);
//        // 必须设置gas费用
//        opt.withGasPrice(new BigInteger("1000000000"));
//        BigDecimal amount = new BigDecimal("10000000");
//        BigInteger decimalPoint = Convert.toWei(new BigDecimal(1), Convert.Unit.ETHER).toBigInteger();
//        amount = amount.multiply(BigDecimal.valueOf(decimalPoint.longValue())).setScale(0, BigDecimal.ROUND_HALF_UP);
//
//        // 合约参数
//        Type initialSupply = new Uint256(amount.toBigInteger());
//        Type name = new Utf8String("bl-n1ft11111");
//        Type symbol = new Utf8String("bl-n1ft11111");
//
//        // 数组的长度等于参数的长度
//        Type[] args = new Type[2];
//        args[0] = name;
//        args[1] = symbol;
//        Arrays.asList(args);
//
//        // 指编译文件中的bytecode
//        String smart_contract_byteCode = "0x60806040526040518060800160405280605181526020016200397c60519139600b908051906020019062000035929190620001d0565b503480156200004357600080fd5b50604051620039cd380380620039cd83398181016040528101906200006991906200041d565b8181816000908051906020019062000083929190620001d0565b5080600190805190602001906200009c929190620001d0565b5050506000600167ffffffffffffffff811115620000bf57620000be620002af565b5b604051908082528060200260200182016040528015620000ee5781602001602082028036833780820191505090505b5090506000816000815181106200010a5762000109620004a2565b5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505073088800000000000000000000000000000000000173ffffffffffffffffffffffffffffffffffffffff166310128d3e826040518263ffffffff1660e01b8152600401620001939190620005d3565b600060405180830381600087803b158015620001ae57600080fd5b505af1158015620001c3573d6000803e3d6000fd5b505050505050506200065c565b828054620001de9062000626565b90600052602060002090601f0160209004810192826200020257600085556200024e565b82601f106200021d57805160ff19168380011785556200024e565b828001600101855582156200024e579182015b828111156200024d57825182559160200191906001019062000230565b5b5090506200025d919062000261565b5090565b5b808211156200027c57600081600090555060010162000262565b5090565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b620002e9826200029e565b810181811067ffffffffffffffff821117156200030b576200030a620002af565b5b80604052505050565b60006200032062000280565b90506200032e8282620002de565b919050565b600067ffffffffffffffff821115620003515762000350620002af565b5b6200035c826200029e565b9050602081019050919050565b60005b83811015620003895780820151818401526020810190506200036c565b8381111562000399576000848401525b50505050565b6000620003b6620003b08462000333565b62000314565b905082815260208101848484011115620003d557620003d462000299565b5b620003e284828562000369565b509392505050565b600082601f83011262000402576200040162000294565b5b8151620004148482602086016200039f565b91505092915050565b600080604083850312156200043757620004366200028a565b5b600083015167ffffffffffffffff8111156200045857620004576200028f565b5b6200046685828601620003ea565b925050602083015167ffffffffffffffff8111156200048a57620004896200028f565b5b6200049885828601620003ea565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006200052a82620004fd565b9050919050565b6200053c816200051d565b82525050565b600062000550838362000531565b60208301905092915050565b6000602082019050919050565b60006200057682620004d1565b620005828185620004dc565b93506200058f83620004ed565b8060005b83811015620005c6578151620005aa888262000542565b9750620005b7836200055c565b92505060018101905062000593565b5085935050505092915050565b60006020820190508181036000830152620005ef818462000569565b905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b600060028204905060018216806200063f57607f821691505b60208210811415620006565762000655620005f7565b5b50919050565b613310806200066c6000396000f3fe608060405234801561001057600080fd5b506004361061012c5760003560e01c80634f6ccce7116100ad578063a22cb46511610071578063a22cb46514610355578063aa46a40014610371578063b88d4fde1461038f578063c87b56dd146103ab578063e985e9c5146103db5761012c565b80634f6ccce71461028b57806355f804b3146102bb5780636352211e146102d757806370a082311461030757806395d89b41146103375761012c565b80631d073a7a116100f45780631d073a7a146101e957806323b872dd146102075780632a240ef0146102235780632f745c591461023f57806342842e0e1461026f5761012c565b806301ffc9a71461013157806306fdde0314610161578063081812fc1461017f578063095ea7b3146101af57806318160ddd146101cb575b600080fd5b61014b60048036038101906101469190611f5c565b61040b565b6040516101589190611fa4565b60405180910390f35b610169610485565b6040516101769190612058565b60405180910390f35b610199600480360381019061019491906120b0565b610517565b6040516101a6919061211e565b60405180910390f35b6101c960048036038101906101c49190612165565b61059c565b005b6101d36106b4565b6040516101e091906121b4565b60405180910390f35b6101f16106c1565b6040516101fe919061222e565b60405180910390f35b610221600480360381019061021c9190612249565b6106d9565b005b61023d6004803603810190610238919061229c565b610739565b005b61025960048036038101906102549190612165565b610798565b60405161026691906121b4565b60405180910390f35b61028960048036038101906102849190612249565b61083d565b005b6102a560048036038101906102a091906120b0565b61085d565b6040516102b291906121b4565b60405180910390f35b6102d560048036038101906102d091906123fe565b6108ce565b005b6102f160048036038101906102ec91906120b0565b6108e8565b6040516102fe919061211e565b60405180910390f35b610321600480360381019061031c919061229c565b61099a565b60405161032e91906121b4565b60405180910390f35b61033f610a52565b60405161034c9190612058565b60405180910390f35b61036f600480360381019061036a9190612473565b610ae4565b005b610379610afa565b60405161038691906121b4565b60405180910390f35b6103a960048036038101906103a49190612554565b610b06565b005b6103c560048036038101906103c091906120b0565b610b68565b6040516103d29190612058565b60405180910390f35b6103f560048036038101906103f091906125d7565b610bea565b6040516104029190611fa4565b60405180910390f35b60007f780e9d63000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916148061047e575061047d82610c7e565b5b9050919050565b60606000805461049490612646565b80601f01602080910402602001604051908101604052809291908181526020018280546104c090612646565b801561050d5780601f106104e25761010080835404028352916020019161050d565b820191906000526020600020905b8154815290600101906020018083116104f057829003601f168201915b5050505050905090565b600061052282610d60565b610561576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610558906126ea565b60405180910390fd5b6004600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b60006105a7826108e8565b90508073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff161415610618576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161060f9061277c565b60405180910390fd5b8073ffffffffffffffffffffffffffffffffffffffff16610637610dcc565b73ffffffffffffffffffffffffffffffffffffffff161480610666575061066581610660610dcc565b610bea565b5b6106a5576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161069c9061280e565b60405180910390fd5b6106af8383610dd4565b505050565b6000600880549050905090565b73088800000000000000000000000000000000000181565b6106ea6106e4610dcc565b82610e8d565b610729576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610720906128a0565b60405180910390fd5b610734838383610f6b565b505050565b610743600a6111d2565b600061074f600a6111e8565b905061075b82826111f6565b7f0f6798a560793a54c3bcfe86a93cde1e73087d944c0ea20544137d4121396885338260405161078c9291906128c0565b60405180910390a15050565b60006107a38361099a565b82106107e4576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016107db9061295b565b60405180910390fd5b600660008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600083815260200190815260200160002054905092915050565b61085883838360405180602001604052806000815250610b06565b505050565b60006108676106b4565b82106108a8576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161089f906129ed565b60405180910390fd5b600882815481106108bc576108bb612a0d565b5b90600052602060002001549050919050565b80600b90805190602001906108e4929190611e4d565b5050565b6000806002600084815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415610991576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161098890612aae565b60405180910390fd5b80915050919050565b60008073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff161415610a0b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610a0290612b40565b60405180910390fd5b600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b606060018054610a6190612646565b80601f0160208091040260200160405190810160405280929190818152602001828054610a8d90612646565b8015610ada5780601f10610aaf57610100808354040283529160200191610ada565b820191906000526020600020905b815481529060010190602001808311610abd57829003601f168201915b5050505050905090565b610af6610aef610dcc565b8383611214565b5050565b600a8060000154905081565b610b17610b11610dcc565b83610e8d565b610b56576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b4d906128a0565b60405180910390fd5b610b6284848484611381565b50505050565b6060610b7382610d60565b610bb2576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ba990612bd2565b60405180910390fd5b610bba6113dd565b610bc38361146f565b604051602001610bd4929190612c7a565b6040516020818303038152906040529050919050565b6000600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b60007f80ac58cd000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19161480610d4957507f5b5e139f000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b80610d595750610d58826115d0565b5b9050919050565b60008073ffffffffffffffffffffffffffffffffffffffff166002600084815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614159050919050565b600033905090565b816004600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16610e47836108e8565b73ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560405160405180910390a45050565b6000610e9882610d60565b610ed7576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ece90612d1b565b60405180910390fd5b6000610ee2836108e8565b90508073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff161480610f245750610f238185610bea565b5b80610f6257508373ffffffffffffffffffffffffffffffffffffffff16610f4a84610517565b73ffffffffffffffffffffffffffffffffffffffff16145b91505092915050565b8273ffffffffffffffffffffffffffffffffffffffff16610f8b826108e8565b73ffffffffffffffffffffffffffffffffffffffff1614610fe1576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610fd890612dad565b60405180910390fd5b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff161415611051576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161104890612e3f565b60405180910390fd5b61105c83838361163a565b611067600082610dd4565b6001600360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282546110b79190612e8e565b925050819055506001600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461110e9190612ec2565b92505081905550816002600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a46111cd83838361174e565b505050565b6001816000016000828254019250508190555050565b600081600001549050919050565b611210828260405180602001604052806000815250611753565b5050565b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff161415611283576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161127a90612f64565b60405180910390fd5b80600560008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31836040516113749190611fa4565b60405180910390a3505050565b61138c848484610f6b565b611398848484846117ae565b6113d7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016113ce90612ff6565b60405180910390fd5b50505050565b6060600b80546113ec90612646565b80601f016020809104026020016040519081016040528092919081815260200182805461141890612646565b80156114655780601f1061143a57610100808354040283529160200191611465565b820191906000526020600020905b81548152906001019060200180831161144857829003601f168201915b5050505050905090565b606060008214156114b7576040518060400160405280600181526020017f300000000000000000000000000000000000000000000000000000000000000081525090506115cb565b600082905060005b600082146114e95780806114d290613016565b915050600a826114e2919061308e565b91506114bf565b60008167ffffffffffffffff811115611505576115046122d3565b5b6040519080825280601f01601f1916602001820160405280156115375781602001600182028036833780820191505090505b5090505b600085146115c4576001826115509190612e8e565b9150600a8561155f91906130bf565b603061156b9190612ec2565b60f81b81838151811061158157611580612a0d565b5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350600a856115bd919061308e565b945061153b565b8093505050505b919050565b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916149050919050565b611645838383611945565b600073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff161415611688576116838161194a565b6116c7565b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16146116c6576116c58382611993565b5b5b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16141561170a5761170581611b00565b611749565b8273ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614611748576117478282611bd1565b5b5b505050565b505050565b61175d8383611c50565b61176a60008484846117ae565b6117a9576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016117a090612ff6565b60405180910390fd5b505050565b60006117cf8473ffffffffffffffffffffffffffffffffffffffff16611e2a565b15611938578373ffffffffffffffffffffffffffffffffffffffff1663150b7a026117f8610dcc565b8786866040518563ffffffff1660e01b815260040161181a9493929190613145565b602060405180830381600087803b15801561183457600080fd5b505af192505050801561186557506040513d601f19601f8201168201806040525081019061186291906131a6565b60015b6118e8573d8060008114611895576040519150601f19603f3d011682016040523d82523d6000602084013e61189a565b606091505b506000815114156118e0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016118d790612ff6565b60405180910390fd5b805181602001fd5b63150b7a0260e01b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19161491505061193d565b600190505b949350505050565b505050565b6008805490506009600083815260200190815260200160002081905550600881908060018154018082558091505060019003906000526020600020016000909190919091505550565b600060016119a08461099a565b6119aa9190612e8e565b9050600060076000848152602001908152602001600020549050818114611a8f576000600660008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600084815260200190815260200160002054905080600660008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600084815260200190815260200160002081905550816007600083815260200190815260200160002081905550505b6007600084815260200190815260200160002060009055600660008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008381526020019081526020016000206000905550505050565b60006001600880549050611b149190612e8e565b9050600060096000848152602001908152602001600020549050600060088381548110611b4457611b43612a0d565b5b906000526020600020015490508060088381548110611b6657611b65612a0d565b5b906000526020600020018190555081600960008381526020019081526020016000208190555060096000858152602001908152602001600020600090556008805480611bb557611bb46131d3565b5b6001900381819060005260206000200160009055905550505050565b6000611bdc8361099a565b905081600660008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600083815260200190815260200160002081905550806007600084815260200190815260200160002081905550505050565b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff161415611cc0576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611cb79061324e565b60405180910390fd5b611cc981610d60565b15611d09576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611d00906132ba565b60405180910390fd5b611d156000838361163a565b6001600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254611d659190612ec2565b92505081905550816002600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a4611e266000838361174e565b5050565b6000808273ffffffffffffffffffffffffffffffffffffffff163b119050919050565b828054611e5990612646565b90600052602060002090601f016020900481019282611e7b5760008555611ec2565b82601f10611e9457805160ff1916838001178555611ec2565b82800160010185558215611ec2579182015b82811115611ec1578251825591602001919060010190611ea6565b5b509050611ecf9190611ed3565b5090565b5b80821115611eec576000816000905550600101611ed4565b5090565b6000604051905090565b600080fd5b600080fd5b60007fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b611f3981611f04565b8114611f4457600080fd5b50565b600081359050611f5681611f30565b92915050565b600060208284031215611f7257611f71611efa565b5b6000611f8084828501611f47565b91505092915050565b60008115159050919050565b611f9e81611f89565b82525050565b6000602082019050611fb96000830184611f95565b92915050565b600081519050919050565b600082825260208201905092915050565b60005b83811015611ff9578082015181840152602081019050611fde565b83811115612008576000848401525b50505050565b6000601f19601f8301169050919050565b600061202a82611fbf565b6120348185611fca565b9350612044818560208601611fdb565b61204d8161200e565b840191505092915050565b60006020820190508181036000830152612072818461201f565b905092915050565b6000819050919050565b61208d8161207a565b811461209857600080fd5b50565b6000813590506120aa81612084565b92915050565b6000602082840312156120c6576120c5611efa565b5b60006120d48482850161209b565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000612108826120dd565b9050919050565b612118816120fd565b82525050565b6000602082019050612133600083018461210f565b92915050565b612142816120fd565b811461214d57600080fd5b50565b60008135905061215f81612139565b92915050565b6000806040838503121561217c5761217b611efa565b5b600061218a85828601612150565b925050602061219b8582860161209b565b9150509250929050565b6121ae8161207a565b82525050565b60006020820190506121c960008301846121a5565b92915050565b6000819050919050565b60006121f46121ef6121ea846120dd565b6121cf565b6120dd565b9050919050565b6000612206826121d9565b9050919050565b6000612218826121fb565b9050919050565b6122288161220d565b82525050565b6000602082019050612243600083018461221f565b92915050565b60008060006060848603121561226257612261611efa565b5b600061227086828701612150565b935050602061228186828701612150565b92505060406122928682870161209b565b9150509250925092565b6000602082840312156122b2576122b1611efa565b5b60006122c084828501612150565b91505092915050565b600080fd5b600080fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b61230b8261200e565b810181811067ffffffffffffffff8211171561232a576123296122d3565b5b80604052505050565b600061233d611ef0565b90506123498282612302565b919050565b600067ffffffffffffffff821115612369576123686122d3565b5b6123728261200e565b9050602081019050919050565b82818337600083830152505050565b60006123a161239c8461234e565b612333565b9050828152602081018484840111156123bd576123bc6122ce565b5b6123c884828561237f565b509392505050565b600082601f8301126123e5576123e46122c9565b5b81356123f584826020860161238e565b91505092915050565b60006020828403121561241457612413611efa565b5b600082013567ffffffffffffffff81111561243257612431611eff565b5b61243e848285016123d0565b91505092915050565b61245081611f89565b811461245b57600080fd5b50565b60008135905061246d81612447565b92915050565b6000806040838503121561248a57612489611efa565b5b600061249885828601612150565b92505060206124a98582860161245e565b9150509250929050565b600067ffffffffffffffff8211156124ce576124cd6122d3565b5b6124d78261200e565b9050602081019050919050565b60006124f76124f2846124b3565b612333565b905082815260208101848484011115612513576125126122ce565b5b61251e84828561237f565b509392505050565b600082601f83011261253b5761253a6122c9565b5b813561254b8482602086016124e4565b91505092915050565b6000806000806080858703121561256e5761256d611efa565b5b600061257c87828801612150565b945050602061258d87828801612150565b935050604061259e8782880161209b565b925050606085013567ffffffffffffffff8111156125bf576125be611eff565b5b6125cb87828801612526565b91505092959194509250565b600080604083850312156125ee576125ed611efa565b5b60006125fc85828601612150565b925050602061260d85828601612150565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b6000600282049050600182168061265e57607f821691505b6020821081141561267257612671612617565b5b50919050565b7f4552433732313a20617070726f76656420717565727920666f72206e6f6e657860008201527f697374656e7420746f6b656e0000000000000000000000000000000000000000602082015250565b60006126d4602c83611fca565b91506126df82612678565b604082019050919050565b60006020820190508181036000830152612703816126c7565b9050919050565b7f4552433732313a20617070726f76616c20746f2063757272656e74206f776e6560008201527f7200000000000000000000000000000000000000000000000000000000000000602082015250565b6000612766602183611fca565b91506127718261270a565b604082019050919050565b6000602082019050818103600083015261279581612759565b9050919050565b7f4552433732313a20617070726f76652063616c6c6572206973206e6f74206f7760008201527f6e6572206e6f7220617070726f76656420666f7220616c6c0000000000000000602082015250565b60006127f8603883611fca565b91506128038261279c565b604082019050919050565b60006020820190508181036000830152612827816127eb565b9050919050565b7f4552433732313a207472616e736665722063616c6c6572206973206e6f74206f60008201527f776e6572206e6f7220617070726f766564000000000000000000000000000000602082015250565b600061288a603183611fca565b91506128958261282e565b604082019050919050565b600060208201905081810360008301526128b98161287d565b9050919050565b60006040820190506128d5600083018561210f565b6128e260208301846121a5565b9392505050565b7f455243373231456e756d657261626c653a206f776e657220696e646578206f7560008201527f74206f6620626f756e6473000000000000000000000000000000000000000000602082015250565b6000612945602b83611fca565b9150612950826128e9565b604082019050919050565b6000602082019050818103600083015261297481612938565b9050919050565b7f455243373231456e756d657261626c653a20676c6f62616c20696e646578206f60008201527f7574206f6620626f756e64730000000000000000000000000000000000000000602082015250565b60006129d7602c83611fca565b91506129e28261297b565b604082019050919050565b60006020820190508181036000830152612a06816129ca565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b7f4552433732313a206f776e657220717565727920666f72206e6f6e657869737460008201527f656e7420746f6b656e0000000000000000000000000000000000000000000000602082015250565b6000612a98602983611fca565b9150612aa382612a3c565b604082019050919050565b60006020820190508181036000830152612ac781612a8b565b9050919050565b7f4552433732313a2062616c616e636520717565727920666f7220746865207a6560008201527f726f206164647265737300000000000000000000000000000000000000000000602082015250565b6000612b2a602a83611fca565b9150612b3582612ace565b604082019050919050565b60006020820190508181036000830152612b5981612b1d565b9050919050565b7f4552433732314d657461646174613a2055524920717565727920666f72206e6f60008201527f6e6578697374656e7420746f6b656e0000000000000000000000000000000000602082015250565b6000612bbc602f83611fca565b9150612bc782612b60565b604082019050919050565b60006020820190508181036000830152612beb81612baf565b9050919050565b600081905092915050565b6000612c0882611fbf565b612c128185612bf2565b9350612c22818560208601611fdb565b80840191505092915050565b7f2e6a736f6e000000000000000000000000000000000000000000000000000000600082015250565b6000612c64600583612bf2565b9150612c6f82612c2e565b600582019050919050565b6000612c868285612bfd565b9150612c928284612bfd565b9150612c9d82612c57565b91508190509392505050565b7f4552433732313a206f70657261746f7220717565727920666f72206e6f6e657860008201527f697374656e7420746f6b656e0000000000000000000000000000000000000000602082015250565b6000612d05602c83611fca565b9150612d1082612ca9565b604082019050919050565b60006020820190508181036000830152612d3481612cf8565b9050919050565b7f4552433732313a207472616e736665722066726f6d20696e636f72726563742060008201527f6f776e6572000000000000000000000000000000000000000000000000000000602082015250565b6000612d97602583611fca565b9150612da282612d3b565b604082019050919050565b60006020820190508181036000830152612dc681612d8a565b9050919050565b7f4552433732313a207472616e7366657220746f20746865207a65726f2061646460008201527f7265737300000000000000000000000000000000000000000000000000000000602082015250565b6000612e29602483611fca565b9150612e3482612dcd565b604082019050919050565b60006020820190508181036000830152612e5881612e1c565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000612e998261207a565b9150612ea48361207a565b925082821015612eb757612eb6612e5f565b5b828203905092915050565b6000612ecd8261207a565b9150612ed88361207a565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff03821115612f0d57612f0c612e5f565b5b828201905092915050565b7f4552433732313a20617070726f766520746f2063616c6c657200000000000000600082015250565b6000612f4e601983611fca565b9150612f5982612f18565b602082019050919050565b60006020820190508181036000830152612f7d81612f41565b9050919050565b7f4552433732313a207472616e7366657220746f206e6f6e20455243373231526560008201527f63656976657220696d706c656d656e7465720000000000000000000000000000602082015250565b6000612fe0603283611fca565b9150612feb82612f84565b604082019050919050565b6000602082019050818103600083015261300f81612fd3565b9050919050565b60006130218261207a565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82141561305457613053612e5f565b5b600182019050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b60006130998261207a565b91506130a48361207a565b9250826130b4576130b361305f565b5b828204905092915050565b60006130ca8261207a565b91506130d58361207a565b9250826130e5576130e461305f565b5b828206905092915050565b600081519050919050565b600082825260208201905092915050565b6000613117826130f0565b61312181856130fb565b9350613131818560208601611fdb565b61313a8161200e565b840191505092915050565b600060808201905061315a600083018761210f565b613167602083018661210f565b61317460408301856121a5565b8181036060830152613186818461310c565b905095945050505050565b6000815190506131a081611f30565b92915050565b6000602082840312156131bc576131bb611efa565b5b60006131ca84828501613191565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603160045260246000fd5b7f4552433732313a206d696e7420746f20746865207a65726f2061646472657373600082015250565b6000613238602083611fca565b915061324382613202565b602082019050919050565b600060208201905081810360008301526132678161322b565b9050919050565b7f4552433732313a20746f6b656e20616c7265616479206d696e74656400000000600082015250565b60006132a4601c83611fca565b91506132af8261326e565b602082019050919050565b600060208201905081810360008301526132d381613297565b905091905056fea26469706673582212205b4df0b693386dfd6fd49a128a0b48fcb93d1699e43b02a9a689489a76a88ec864736f6c6343000809003368747470733a2f2f7473706163652d313235333437303031342e636f732e61702d686f6e676b6f6e672e6d7971636c6f75642e636f6d2f6e66742f636678626a67656e657369732f6d657461646174612f";
//        // 调用合约进行部署
//        //String deploye_hash = account.deploy(opt,smart_contract_byteCode,args);
//        String deploye_hash = account.deploy(opt, smart_contract_byteCode, args);
//
//        Receipt transactionReceipt = web3.waitForReceipt(deploye_hash);
//
//        System.out.println("部署合约地址" + transactionReceipt.getContractCreated().get().getAddress().toString());
//        System.out.println("交易状态" + transactionReceipt.getOutcomeStatus());
//        transactionReceipt.getOutcomeStatus();
//        System.out.println(transactionReceipt);
//
//        System.out.println(deploye_hash);
//    }
//
//    /**
//     * 给新创建的账户装原生代币
//     *
//     * @throws Exception
//     */
//    @Test
//    public void transaction() throws Exception {
//        Web3 web3 = Web3.create("https://test.confluxrpc.com/v2", 3, 1000);
//        BigInteger value = new BigInteger("1000", 16);
//        TransactionBuilder txBuilder = new TransactionBuilder(new Address("0x-the-sender-address"));
//        txBuilder.withChainId(1);
//        txBuilder.withTo(new Address("cfxtest:aak7fsws4u4yf38fk870218p1h3gxut3ku00u1k1da"));
//        txBuilder.withValue(value);
//        conflux.web3j.types.RawTransaction rawTx = txBuilder.build(web3);
//        // get account from accountManager, `account.send` will sign the tx and send it to blockchain
//        // 整合一个账户信息，是条链，插件密码和公私钥
//        Account account = Account.create(web3, "");
//        SendTransactionResult result = account.send(rawTx);
//        System.out.println(result.getTxHash());
//        // or you can manually sign and send
//        String hexEncodedTx = account.sign(rawTx);
//        String txHash = web3.sendRawTransaction(hexEncodedTx).sendAndGet();
//
//    }
//
//    /**
//     * 原生代币转账交易
//     *
//     * @throws Exception
//     */
//    @Test
//    public void baseTransact() throws Exception {
//        // 确定基础参数 公钥私钥和密码,密码不能乱写！必须是浏览器conflux钱包插件的密码！！
//        int testNetId = 1;
//        // 出钱人私钥
//        String privateKey = "0x2e0d3e928841568bcfcc2eaa5bf2424321abe3ae6ac2bdfea6786b659e2e5d51";
//        String password = "c45521669";
//        // 出钱人公钥
//        String publickKey = "0x1d23e8060f646bad1b4bb9125a5d1e71f56cb32f";
//        // Address 封装的对象可以用 getABIAddress()获取被封装账号的公钥地址
//        Address test_address = new Address(publickKey, testNetId);
//        // initialize  an accountManager
//        Web3 web3 = Web3.create("https://test.confluxrpc.org/v2", 3, 1000);
//        AccountManager am = new AccountManager(testNetId);
//        // import private key
//        am.imports(privateKey, password);
//        // 整合一个账户信息，是条链，插件密码和公私钥
//        Account account = Account.unlock(web3, am, test_address, password);
//        // 还有一种封印的account函数，详见上文jdk链接
//        // 尝试发送部分代币
//        // 1.建立交易信息 2.私钥签名 3.发送给本地或公用节点
//        // 交易值，前面10进制字符串，单位为drip！！=10^-18 个cfx
//        BigInteger value = new BigInteger("1000000", 10);
//        // 创建交易，参数发送者地址
//        TransactionBuilder txBuilder = new TransactionBuilder(test_address);
//        // 参数--链号！！容易遗忘，报bug：chainIdMissed
//        txBuilder.withChainId(testNetId);
//        // 参数 接收地址和链号
//        Address receiverAddress = new Address("0x173329e2a911b3849bf41e65c807ceaefa2b11d1", testNetId);
//        // 设置接收者的地址
//        txBuilder.withTo(receiverAddress);
//        // 交易值确认，类型为biginteger
//        txBuilder.withValue(value);
//        // 根据之前的交易信息实例化交易
//        RawTransaction rawTx = txBuilder.build(web3);
////        // 交易上传区块链，完成流程，收到确认区块地址哈希
//        //这种上传包括加密签名和发送
////        SendTransactionResult result = account.send(rawTx);
////        System.out.println(result.getTxHash());
//        // 也可以分开，先加密签名，再传送
//        String hexEncodedTx = account.sign(rawTx);
//        String txHash = web3.sendRawTransaction(hexEncodedTx).sendAndGet();
//        System.out.println(txHash);
//        System.out.println("###############################");
//    }
}